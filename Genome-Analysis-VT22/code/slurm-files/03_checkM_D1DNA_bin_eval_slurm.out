#!/bin/bash -l
#SBATCH -A uppmax2022-2-5 -M snowy
#SBATCH -p core
#SBATCH -n 4
#SBATCH -J 03_checkM_D1DNA_bin_eval
#SBATCH -t 02:00:00
#SBATCH --mail-type=ALL
#SBATCH --mail-user jay.hakansson.4449@student.uu.se

cat $0
echo QOS = $SLURM_JOB_QOS

export GAVT22=$HOME/genome_analysis_project/Genome-Analysis-VT22/
#Seems I need the checkM data in my home directory
cd $HOME
mkdir CheckM_data
cd CheckM_data

module load bioinfo-tools CheckM/1.1.3
#setup of local database
cp -av $CHECKM_DATA/checkm_data_2015_01_16.tar.gz .
mkdir 2015_01_16
cd 2015_01_16
tar xzf ../checkm_data_2015_01_16.tar.gz
#tell CheckM where the data is
checkm data setRoot $PWD

cd $SNIC_TMP
checkm lineage_wf -t 4 -x fa --reduced_tree $GAVT22/analyses/03_binning/D1DNA_bins/final.contigs.fa.metabat-bins/ $GAVT22/analyses/03_binning/D1DNA_bins/bins_eval_04-28
QOS = normal
Several complimentary python scripts are available with pplacer/1.1.alpha19. 'module help pplacer/1.1.alpha19' for more information
To set up a CheckM data directory, see 'module help CheckM/1.1.3'
‘/sw/bioinfo/CheckM/data/checkm_data_2015_01_16.tar.gz’ -> ‘./checkm_data_2015_01_16.tar.gz’
tar: ./distributions/cd_dist.txt: Cannot utime: Stale file handle
tar: ./distributions/gc_dist.txt: Cannot utime: Stale file handle
tar: ./distributions/gc_dist.txt: Cannot close: Stale file handle
tar: ./genome_tree/genome_tree.metadata.tsv: Cannot utime: Stale file handle
tar: ./genome_tree/genome_tree.metadata.tsv: Cannot close: Stale file handle
tar: ./genome_tree/genome_tree_reduced.refpkg/genome_tree.fasta: Cannot utime: Stale file handle
tar: ./genome_tree/genome_tree_reduced.refpkg/genome_tree.fasta: Cannot close: Stale file handle
tar: ./genome_tree/genome_tree_full.refpkg/genome_tree.fasta: Cannot utime: Stale file handle
tar: ./genome_tree/genome_tree_full.refpkg/genome_tree.fasta: Cannot close: Stale file handle
tar: ./genome_tree/genome_tree_full.refpkg/genome_tree.log: Cannot utime: Stale file handle
tar: ./genome_tree/genome_tree_full.refpkg/genome_tree.log: Cannot close: Stale file handle
tar: ./hmms/checkm.hmm: Cannot utime: Stale file handle
tar: ./hmms/checkm.hmm: Cannot close: Stale file handle
tar: Exiting with failure status due to previous errors
[2022-04-28 13:37:55] INFO: CheckM v1.1.3
[2022-04-28 13:37:55] INFO: checkm data setRoot /home/jay/CheckM_data/2015_01_16
[2022-04-28 13:37:55] INFO: [CheckM - data] Check for database updates. [setRoot]

Path [/home/jay/CheckM_data/2015_01_16] exists and you have permission to write to this folder.
(re) creating manifest file (please be patient).

Path [/home/jay/CheckM_data/2015_01_16] exists and you have permission to write to this folder.
(re) creating manifest file (please be patient).
[2022-04-28 13:38:16] INFO: CheckM v1.1.3
[2022-04-28 13:38:16] INFO: checkm lineage_wf -t 4 -x fa --reduced_tree /home/jay/genome_analysis_project/Genome-Analysis-VT22//analyses/03_binning/D1DNA_bins/final.contigs.fa.metabat-bins/ /home/jay/genome_analysis_project/Genome-Analysis-VT22//analyses/03_binning/D1DNA_bins/bins_eval_04-28
[2022-04-28 13:38:16] INFO: [CheckM - tree] Placing bins in reference genome tree.
[2022-04-28 13:38:16] INFO: Identifying marker genes in 16 bins with 4 threads:
    Finished processing 0 of 16 (0.00%) bins.    Finished processing 1 of 16 (6.25%) bins.    Finished processing 2 of 16 (12.50%) bins.    Finished processing 3 of 16 (18.75%) bins.    Finished processing 4 of 16 (25.00%) bins.    Finished processing 5 of 16 (31.25%) bins.    Finished processing 6 of 16 (37.50%) bins.    Finished processing 7 of 16 (43.75%) bins.    Finished processing 8 of 16 (50.00%) bins.    Finished processing 9 of 16 (56.25%) bins.    Finished processing 10 of 16 (62.50%) bins.    Finished processing 11 of 16 (68.75%) bins.    Finished processing 12 of 16 (75.00%) bins.    Finished processing 13 of 16 (81.25%) bins.    Finished processing 14 of 16 (87.50%) bins.    Finished processing 15 of 16 (93.75%) bins.    Finished processing 16 of 16 (100.00%) bins.
[2022-04-28 13:38:46] INFO: Saving HMM info to file.
[2022-04-28 13:38:46] INFO: Calculating genome statistics for 16 bins with 4 threads:
    Finished processing 0 of 16 (0.00%) bins.    Finished processing 1 of 16 (6.25%) bins.    Finished processing 2 of 16 (12.50%) bins.    Finished processing 3 of 16 (18.75%) bins.    Finished processing 4 of 16 (25.00%) bins.    Finished processing 5 of 16 (31.25%) bins.    Finished processing 6 of 16 (37.50%) bins.    Finished processing 7 of 16 (43.75%) bins.    Finished processing 8 of 16 (50.00%) bins.    Finished processing 9 of 16 (56.25%) bins.    Finished processing 10 of 16 (62.50%) bins.    Finished processing 11 of 16 (68.75%) bins.    Finished processing 12 of 16 (75.00%) bins.    Finished processing 13 of 16 (81.25%) bins.    Finished processing 14 of 16 (87.50%) bins.    Finished processing 15 of 16 (93.75%) bins.    Finished processing 16 of 16 (100.00%) bins.
[2022-04-28 13:38:47] INFO: Extracting marker genes to align.
[2022-04-28 13:38:47] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 16 (6.25%) bins.    Finished parsing hits for 2 of 16 (12.50%) bins.    Finished parsing hits for 3 of 16 (18.75%) bins.    Finished parsing hits for 4 of 16 (25.00%) bins.    Finished parsing hits for 5 of 16 (31.25%) bins.    Finished parsing hits for 6 of 16 (37.50%) bins.    Finished parsing hits for 7 of 16 (43.75%) bins.    Finished parsing hits for 8 of 16 (50.00%) bins.    Finished parsing hits for 9 of 16 (56.25%) bins.    Finished parsing hits for 10 of 16 (62.50%) bins.    Finished parsing hits for 11 of 16 (68.75%) bins.    Finished parsing hits for 12 of 16 (75.00%) bins.    Finished parsing hits for 13 of 16 (81.25%) bins.    Finished parsing hits for 14 of 16 (87.50%) bins.    Finished parsing hits for 15 of 16 (93.75%) bins.    Finished parsing hits for 16 of 16 (100.00%) bins.[2022-04-28 13:38:48] INFO: Extracting 43 HMMs with 4 threads:

    Finished extracting 0 of 43 (0.00%) HMMs.    Finished extracting 1 of 43 (2.33%) HMMs.    Finished extracting 2 of 43 (4.65%) HMMs.    Finished extracting 3 of 43 (6.98%) HMMs.    Finished extracting 4 of 43 (9.30%) HMMs.    Finished extracting 5 of 43 (11.63%) HMMs.    Finished extracting 6 of 43 (13.95%) HMMs.    Finished extracting 7 of 43 (16.28%) HMMs.    Finished extracting 8 of 43 (18.60%) HMMs.    Finished extracting 9 of 43 (20.93%) HMMs.    Finished extracting 10 of 43 (23.26%) HMMs.    Finished extracting 11 of 43 (25.58%) HMMs.    Finished extracting 12 of 43 (27.91%) HMMs.    Finished extracting 13 of 43 (30.23%) HMMs.    Finished extracting 14 of 43 (32.56%) HMMs.    Finished extracting 15 of 43 (34.88%) HMMs.    Finished extracting 16 of 43 (37.21%) HMMs.    Finished extracting 17 of 43 (39.53%) HMMs.    Finished extracting 18 of 43 (41.86%) HMMs.    Finished extracting 19 of 43 (44.19%) HMMs.    Finished extracting 20 of 43 (46.51%) HMMs.    Finished extracting 21 of 43 (48.84%) HMMs.    Finished extracting 22 of 43 (51.16%) HMMs.    Finished extracting 23 of 43 (53.49%) HMMs.    Finished extracting 24 of 43 (55.81%) HMMs.    Finished extracting 25 of 43 (58.14%) HMMs.    Finished extracting 26 of 43 (60.47%) HMMs.    Finished extracting 27 of 43 (62.79%) HMMs.    Finished extracting 28 of 43 (65.12%) HMMs.    Finished extracting 29 of 43 (67.44%) HMMs.    Finished extracting 30 of 43 (69.77%) HMMs.    Finished extracting 31 of 43 (72.09%) HMMs.    Finished extracting 32 of 43 (74.42%) HMMs.    Finished extracting 33 of 43 (76.74%) HMMs.    Finished extracting 34 of 43 (79.07%) HMMs.    Finished extracting 35 of 43 (81.40%) HMMs.    Finished extracting 36 of 43 (83.72%) HMMs.    Finished extracting 37 of 43 (86.05%) HMMs.    Finished extracting 38 of 43 (88.37%) HMMs.    Finished extracting 39 of 43 (90.70%) HMMs.    Finished extracting 40 of 43 (93.02%) HMMs.    Finished extracting 41 of 43 (95.35%) HMMs.    Finished extracting 42 of 43 (97.67%) HMMs.    Finished extracting 43 of 43 (100.00%) HMMs.
[2022-04-28 13:38:48] INFO: Aligning 43 marker genes with 4 threads:
    Finished aligning 0 of 43 (0.00%) marker genes.    Finished aligning 1 of 43 (2.33%) marker genes.    Finished aligning 2 of 43 (4.65%) marker genes.    Finished aligning 3 of 43 (6.98%) marker genes.    Finished aligning 4 of 43 (9.30%) marker genes.    Finished aligning 5 of 43 (11.63%) marker genes.    Finished aligning 6 of 43 (13.95%) marker genes.    Finished aligning 7 of 43 (16.28%) marker genes.    Finished aligning 8 of 43 (18.60%) marker genes.    Finished aligning 9 of 43 (20.93%) marker genes.    Finished aligning 10 of 43 (23.26%) marker genes.    Finished aligning 11 of 43 (25.58%) marker genes.    Finished aligning 12 of 43 (27.91%) marker genes.    Finished aligning 13 of 43 (30.23%) marker genes.    Finished aligning 14 of 43 (32.56%) marker genes.    Finished aligning 15 of 43 (34.88%) marker genes.    Finished aligning 16 of 43 (37.21%) marker genes.    Finished aligning 17 of 43 (39.53%) marker genes.    Finished aligning 18 of 43 (41.86%) marker genes.    Finished aligning 19 of 43 (44.19%) marker genes.    Finished aligning 20 of 43 (46.51%) marker genes.    Finished aligning 21 of 43 (48.84%) marker genes.    Finished aligning 22 of 43 (51.16%) marker genes.    Finished aligning 23 of 43 (53.49%) marker genes.    Finished aligning 24 of 43 (55.81%) marker genes.    Finished aligning 25 of 43 (58.14%) marker genes.    Finished aligning 26 of 43 (60.47%) marker genes.    Finished aligning 27 of 43 (62.79%) marker genes.    Finished aligning 28 of 43 (65.12%) marker genes.    Finished aligning 29 of 43 (67.44%) marker genes.    Finished aligning 30 of 43 (69.77%) marker genes.    Finished aligning 31 of 43 (72.09%) marker genes.    Finished aligning 32 of 43 (74.42%) marker genes.    Finished aligning 33 of 43 (76.74%) marker genes.    Finished aligning 34 of 43 (79.07%) marker genes.    Finished aligning 35 of 43 (81.40%) marker genes.    Finished aligning 36 of 43 (83.72%) marker genes.    Finished aligning 37 of 43 (86.05%) marker genes.    Finished aligning 38 of 43 (88.37%) marker genes.    Finished aligning 39 of 43 (90.70%) marker genes.    Finished aligning 40 of 43 (93.02%) marker genes.    Finished aligning 41 of 43 (95.35%) marker genes.    Finished aligning 42 of 43 (97.67%) marker genes.    Finished aligning 43 of 43 (100.00%) marker genes.
[2022-04-28 13:38:49] INFO: Reading marker alignment files.
[2022-04-28 13:38:49] INFO: Concatenating alignments.
[2022-04-28 13:38:49] INFO: Placing 16 bins into the genome tree with pplacer (be patient).
[2022-04-28 13:42:22] INFO: { Current stage: 0:04:06.700 || Total: 0:04:06.700 }
[2022-04-28 13:42:22] INFO: [CheckM - lineage_set] Inferring lineage-specific marker sets.
[2022-04-28 13:42:22] INFO: Reading HMM info from file.
[2022-04-28 13:42:22] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 16 (6.25%) bins.    Finished parsing hits for 2 of 16 (12.50%) bins.    Finished parsing hits for 3 of 16 (18.75%) bins.    Finished parsing hits for 4 of 16 (25.00%) bins.    Finished parsing hits for 5 of 16 (31.25%) bins.    Finished parsing hits for 6 of 16 (37.50%) bins.    Finished parsing hits for 7 of 16 (43.75%) bins.    Finished parsing hits for 8 of 16 (50.00%) bins.    Finished parsing hits for 9 of 16 (56.25%) bins.    Finished parsing hits for 10 of 16 (62.50%) bins.    Finished parsing hits for 11 of 16 (68.75%) bins.    Finished parsing hits for 12 of 16 (75.00%) bins.    Finished parsing hits for 13 of 16 (81.25%) bins.    Finished parsing hits for 14 of 16 (87.50%) bins.    Finished parsing hits for 15 of 16 (93.75%) bins.    Finished parsing hits for 16 of 16 (100.00%) bins.[2022-04-28 13:42:23] INFO: Determining marker sets for each genome bin.

    Finished processing 1 of 16 (6.25%) bins (current: bin.1).                                                                  Finished processing 2 of 16 (12.50%) bins (current: bin.10).                                                                    Finished processing 3 of 16 (18.75%) bins (current: bin.11).                                                                    Finished processing 4 of 16 (25.00%) bins (current: bin.12).                                                                    Finished processing 5 of 16 (31.25%) bins (current: bin.13).                                                                    Finished processing 6 of 16 (37.50%) bins (current: bin.14).                                                                    Finished processing 7 of 16 (43.75%) bins (current: bin.15).                                                                    Finished processing 8 of 16 (50.00%) bins (current: bin.16).                                                                    Finished processing 9 of 16 (56.25%) bins (current: bin.2).                                                                   Finished processing 10 of 16 (62.50%) bins (current: bin.3).                                                                    Finished processing 11 of 16 (68.75%) bins (current: bin.4).                                                                    Finished processing 12 of 16 (75.00%) bins (current: bin.5).                                                                    Finished processing 13 of 16 (81.25%) bins (current: bin.6).                                                                    Finished processing 14 of 16 (87.50%) bins (current: bin.7).                                                                    Finished processing 15 of 16 (93.75%) bins (current: bin.8).                                                                    Finished processing 16 of 16 (100.00%) bins (current: bin.9).[2022-04-28 13:42:26] INFO: Marker set written to: /home/jay/genome_analysis_project/Genome-Analysis-VT22//analyses/03_binning/D1DNA_bins/bins_eval_04-28/lineage.ms
[2022-04-28 13:42:26] INFO: { Current stage: 0:00:03.964 || Total: 0:04:10.665 }
[2022-04-28 13:42:26] INFO: [CheckM - analyze] Identifying marker genes in bins.
[2022-04-28 13:42:27] INFO: Identifying marker genes in 16 bins with 4 threads:

    Finished processing 0 of 16 (0.00%) bins.    Finished processing 1 of 16 (6.25%) bins.    Finished processing 2 of 16 (12.50%) bins.    Finished processing 3 of 16 (18.75%) bins.    Finished processing 4 of 16 (25.00%) bins.    Finished processing 5 of 16 (31.25%) bins.    Finished processing 6 of 16 (37.50%) bins.    Finished processing 7 of 16 (43.75%) bins.    Finished processing 8 of 16 (50.00%) bins.    Finished processing 9 of 16 (56.25%) bins.    Finished processing 10 of 16 (62.50%) bins.    Finished processing 11 of 16 (68.75%) bins.    Finished processing 12 of 16 (75.00%) bins.    Finished processing 13 of 16 (81.25%) bins.    Finished processing 14 of 16 (87.50%) bins.    Finished processing 15 of 16 (93.75%) bins.    Finished processing 16 of 16 (100.00%) bins.
[2022-04-28 13:45:01] INFO: Saving HMM info to file.
[2022-04-28 13:45:02] INFO: { Current stage: 0:02:35.446 || Total: 0:06:46.111 }
[2022-04-28 13:45:02] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 16 (6.25%) bins.    Finished parsing hits for 2 of 16 (12.50%) bins.    Finished parsing hits for 3 of 16 (18.75%) bins.    Finished parsing hits for 4 of 16 (25.00%) bins.    Finished parsing hits for 5 of 16 (31.25%) bins.    Finished parsing hits for 6 of 16 (37.50%) bins.    Finished parsing hits for 7 of 16 (43.75%) bins.    Finished parsing hits for 8 of 16 (50.00%) bins.    Finished parsing hits for 9 of 16 (56.25%) bins.    Finished parsing hits for 10 of 16 (62.50%) bins.    Finished parsing hits for 11 of 16 (68.75%) bins.    Finished parsing hits for 12 of 16 (75.00%) bins.    Finished parsing hits for 13 of 16 (81.25%) bins.    Finished parsing hits for 14 of 16 (87.50%) bins.    Finished parsing hits for 15 of 16 (93.75%) bins.    Finished parsing hits for 16 of 16 (100.00%) bins.[2022-04-28 13:45:04] INFO: Aligning marker genes with multiple hits in a single bin:

    Finished processing 0 of 16 (0.00%) bins.    Finished processing 1 of 16 (6.25%) bins.    Finished processing 2 of 16 (12.50%) bins.    Finished processing 3 of 16 (18.75%) bins.    Finished processing 4 of 16 (25.00%) bins.    Finished processing 5 of 16 (31.25%) bins.    Finished processing 6 of 16 (37.50%) bins.    Finished processing 7 of 16 (43.75%) bins.    Finished processing 8 of 16 (50.00%) bins.    Finished processing 9 of 16 (56.25%) bins.    Finished processing 10 of 16 (62.50%) bins.    Finished processing 11 of 16 (68.75%) bins.    Finished processing 12 of 16 (75.00%) bins.    Finished processing 13 of 16 (81.25%) bins.    Finished processing 14 of 16 (87.50%) bins.    Finished processing 15 of 16 (93.75%) bins.    Finished processing 16 of 16 (100.00%) bins.
[2022-04-28 13:45:11] INFO: { Current stage: 0:00:08.751 || Total: 0:06:54.863 }
[2022-04-28 13:45:11] INFO: Calculating genome statistics for 16 bins with 4 threads:
    Finished processing 0 of 16 (0.00%) bins.    Finished processing 1 of 16 (6.25%) bins.    Finished processing 2 of 16 (12.50%) bins.    Finished processing 3 of 16 (18.75%) bins.    Finished processing 4 of 16 (25.00%) bins.    Finished processing 5 of 16 (31.25%) bins.    Finished processing 6 of 16 (37.50%) bins.    Finished processing 7 of 16 (43.75%) bins.    Finished processing 8 of 16 (50.00%) bins.    Finished processing 9 of 16 (56.25%) bins.    Finished processing 10 of 16 (62.50%) bins.    Finished processing 11 of 16 (68.75%) bins.    Finished processing 12 of 16 (75.00%) bins.    Finished processing 13 of 16 (81.25%) bins.    Finished processing 14 of 16 (87.50%) bins.    Finished processing 15 of 16 (93.75%) bins.    Finished processing 16 of 16 (100.00%) bins.
[2022-04-28 13:45:11] INFO: { Current stage: 0:00:00.373 || Total: 0:06:55.237 }
[2022-04-28 13:45:11] INFO: [CheckM - qa] Tabulating genome statistics.
[2022-04-28 13:45:11] INFO: Calculating AAI between multi-copy marker genes.
[2022-04-28 13:45:11] INFO: Reading HMM info from file.
[2022-04-28 13:45:11] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 16 (6.25%) bins.    Finished parsing hits for 2 of 16 (12.50%) bins.    Finished parsing hits for 3 of 16 (18.75%) bins.    Finished parsing hits for 4 of 16 (25.00%) bins.    Finished parsing hits for 5 of 16 (31.25%) bins.    Finished parsing hits for 6 of 16 (37.50%) bins.    Finished parsing hits for 7 of 16 (43.75%) bins.    Finished parsing hits for 8 of 16 (50.00%) bins.    Finished parsing hits for 9 of 16 (56.25%) bins.    Finished parsing hits for 10 of 16 (62.50%) bins.    Finished parsing hits for 11 of 16 (68.75%) bins.    Finished parsing hits for 12 of 16 (75.00%) bins.    Finished parsing hits for 13 of 16 (81.25%) bins.    Finished parsing hits for 14 of 16 (87.50%) bins.    Finished parsing hits for 15 of 16 (93.75%) bins.    Finished parsing hits for 16 of 16 (100.00%) bins.---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  Bin Id            Marker lineage            # genomes   # markers   # marker sets    0     1    2    3    4    5+   Completeness   Contamination   Strain heterogeneity  
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  bin.8          k__Bacteria (UID203)            5449        104            58         1     6    25   30   21   21      98.28           226.17              6.29          
  bin.1           k__Archaea (UID2)              207         145           103         15    96   32   2    0    0       92.27           26.05               7.89          
  bin.6           k__Archaea (UID2)              207         145           103         39   103   3    0    0    0       71.37            2.91              33.33          
  bin.2         k__Bacteria (UID2565)            2921        142            87         36   106   0    0    0    0       69.76            0.00               0.00          
  bin.9        p__Euryarchaeota (UID3)           148         188           125         45   142   1    0    0    0       69.20            0.80              100.00         
  bin.12        k__Bacteria (UID1453)            901         171           117         49   119   3    0    0    0       64.44            2.14               0.00          
  bin.5           k__Archaea (UID2)              207         145           103         52    93   0    0    0    0       62.87            0.00               0.00          
  bin.15     o__Actinomycetales (UID1663)        488         310           185        118   189   3    0    0    0       55.09            0.80              33.33          
  bin.10         k__Bacteria (UID203)            5449        104            58         72    28   4    0    0    0       48.28            6.90              25.00          
  bin.16     o__Actinomycetales (UID1663)        488         310           185        162   143   5    0    0    0       42.62            1.25              80.00          
  bin.4           k__Archaea (UID2)              207         149           107         99    50   0    0    0    0       39.72            0.00               0.00          
  bin.13       p__Euryarchaeota (UID3)           148         188           125        115    71   2    0    0    0       38.67            1.07              100.00         
  bin.3    c__Gammaproteobacteria (UID4202)       67         481           276        336   140   5    0    0    0       32.67            1.49               0.00          
  bin.7         k__Bacteria (UID1453)            901         171           117        128    43   0    0    0    0       22.53            0.00               0.00          
  bin.11       p__Euryarchaeota (UID3)           148         188           125        131    57   0    0    0    0       21.55            0.00               0.00          
  bin.14         k__Bacteria (UID203)            5449        103            57         94    9    0    0    0    0       14.04            0.00               0.00          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[2022-04-28 13:45:14] INFO: { Current stage: 0:00:02.731 || Total: 0:06:57.969 }

